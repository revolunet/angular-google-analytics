/**
 * Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v0.0.3 - 2014-08-27
 * @link http://revolunet.com.github.com/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-google-analytics",[]).provider("Analytics",function(){var a,b,c,d,e=!1,f=!0,g="",h=!1,i="$routeChangeSuccess",j="auto",k=!1,l=!1,m=!1;this._logs=[],this.setAccount=function(b){return a=b,!0},this.trackPages=function(a){return f=a,!0},this.trackPrefix=function(a){return g=a,!0},this.setDomainName=function(a){return b=a,!0},this.useAnalytics=function(a){return h=!!a,!0},this.useEnhancedLinkAttribution=function(a){return l=!!a,!0},this.setPageEvent=function(a){return i=a,!0},this.setCookieConfig=function(a){return j=a,!0},this.useECommerce=function(a){return k=!!a,!0},this.setRemoveRegExp=function(a){return a instanceof RegExp?(c=a,!0):!1},this.setExperimentId=function(a){return d=a,!0},this.ignoreFirstPageLoad=function(a){m=!!a},this.$get=["$document","$rootScope","$location","$window",function(n,o,p,q){function r(){a&&(q._gaq=[],q._gaq.push(["_setAccount",a]),l&&q._gaq.push(["_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"]),f&&!m&&q._gaq.push(c?["_trackPageview",t()]:["_trackPageview"]),b&&q._gaq.push(["_setDomainName",b]),function(){var a=n[0],b=a.createElement("script");b.type="text/javascript",b.async=!0,b.src=("https:"===a.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var c=a.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}(),e=!0)}function s(){if(!a)return console.warn("No account id set for Analytics.js");if(function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),angular.isArray(a)?a.forEach(function(a){q.ga("create",a.tracker,j,{name:a.name})}):q.ga("create",a,j),f&&!m&&q.ga("send","pageview",t()),q.ga&&(k&&q.ga("require","ecommerce","ecommerce.js"),l&&q.ga("require","linkid","linkid.js"),d)){var b=document.createElement("script"),c=document.getElementsByTagName("script")[0];b.src="//www.google-analytics.com/cx/api.js?experiment="+d,c.parentNode.insertBefore(b,c)}}var t=function(){var a=p.path();return c?a.replace(c,""):a};this._log=function(){this._logs.push(arguments)},this._trackPage=function(b,c){c=c?c:n[0].title,f&&!h&&q._gaq?(q._gaq.push(["_set","title",c]),q._gaq.push(["_trackPageview",g+b]),this._log("_trackPageview",arguments)):f&&h&&q.ga&&(angular.isArray(a)?a.forEach(function(a){q.ga(a.name+".send","pageview",{page:g+b,title:c})}):q.ga("send","pageview",{page:g+b,title:c}),this._log("pageview",arguments))},this._trackEvent=function(a,b,c,d){!h&&q._gaq?(q._gaq.push(["_trackEvent",a,b,c,d]),this._log("trackEvent",arguments)):q.ga&&(q.ga("send","event",a,b,c,d),this._log("event",arguments))},this._addTrans=function(a,b,c,d,e,f,g,i,j){!h&&q._gaq?(q._gaq.push(["_addTrans",a,b,c,d,e,f,g,i]),this._log("_addTrans",arguments)):q.ga&&(k?(q.ga("ecommerce:addTransaction",{id:a,affiliation:b,revenue:c,tax:d,shipping:e,currency:j||"USD"}),this._log("ecommerce:addTransaction",arguments)):console.warn("ecommerce no set. Use AnalyticsProvider.setECommerce(true);"))},this._addItem=function(a,b,c,d,e,f){!h&&q._gaq?(q._gaq.push(["_addItem",a,b,c,d,e,f]),this._log("_addItem",arguments)):q.ga&&(q.ga("ecommerce:addItem",{id:a,name:c,sku:b,category:d,price:e,quantity:f}),this._log("ecommerce:addItem",arguments))},this._trackTrans=function(){!h&&q._gaq?(q._gaq.push(["_trackTrans"]),this._log("_trackTrans",arguments)):q.ga&&(q.ga("ecommerce:send"),this._log("ecommerce:send",arguments))},this._clearTrans=function(){q.ga&&(q.ga("ecommerce:clear"),this._log("ecommerce:clear",arguments))},this._send=function(a){q.ga&&(q.ga("send",a),this._log("send",a))},this._set=function(a,b){q.ga&&(q.ga("set",a,b),this._log("set",a,b))},h?s():r();var u=this;return f&&o.$on(i,function(){u._trackPage(t())}),{_logs:u._logs,cookieConfig:j,ecommerce:k,enhancedLinkAttribution:l,getUrl:t,experimentId:d,ignoreFirstPageLoad:m,trackPage:function(a,b){u._trackPage(a,b)},trackEvent:function(a,b,c,d){u._trackEvent(a,b,c,d)},addTrans:function(a,b,c,d,e,f,g,h,i){u._addTrans(a,b,c,d,e,f,g,h,i)},addItem:function(a,b,c,d,e,f){u._addItem(a,b,c,d,e,f)},trackTrans:function(){u._trackTrans()},clearTrans:function(){u._clearTrans()},send:function(a){u._send(a)},set:function(a,b){u._set(a,b)}}}]});